<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>{{ title or "GemGuide.space" }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#EEF2FF',
                            100: '#E0E7FF',
                            200: '#C7D2FE',
                            300: '#A5B4FC',
                            400: '#818CF8',
                            500: '#6366F1',
                            600: '#4F46E5',
                            700: '#4338CA',
                            800: '#3730A3',
                            900: '#312E81',
                        },
                        accent: {
                            50: '#FDF4FF',
                            100: '#FAE8FF',
                            200: '#F5D0FE',
                            300: '#F0ABFC',
                            400: '#E879F9',
                            500: '#D946EF',
                            600: '#C026D3',
                            700: '#A21CAF',
                            800: '#86198F',
                            900: '#701A75',
                        },
                        success: {
                            50: '#F0FDF4',
                            100: '#DCFCE7',
                            200: '#BBF7D0',
                            300: '#86EFAC',
                            400: '#4ADE80',
                            500: '#22C55E',
                            600: '#16A34A',
                            700: '#15803D',
                            800: '#166534',
                            900: '#14532D',
                        },
                        warning: {
                            50: '#FFFBEB',
                            100: '#FEF3C7',
                            200: '#FDE68A',
                            300: '#FCD34D',
                            400: '#FBBF24',
                            500: '#F59E0B',
                            600: '#D97706',
                            700: '#B45309',
                            800: '#92400E',
                            900: '#78350F',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter var', 'Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'hover': '0 10px 40px -10px rgba(0, 0, 0, 0.12), 0 20px 30px -5px rgba(0, 0, 0, 0.08)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-in-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'slide-down': 'slideDown 0.4s ease-out',
                        'scale-in': 'scaleIn 0.2s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(-10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.95)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            font-family: 'Inter var', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        body {
            background: #ffffff;
            color: #1e293b;
            letter-spacing: -0.011em;
            line-height: 1.6;
        }
        @media (max-width: 1024px) { body { padding-bottom: 80px; } }
        @media (min-width: 1024px) { body { padding-left: 240px; } }

        .sidebar { background: #ffffff; border-right: 1px solid #e5e7eb; box-shadow: none; }
        .nav-item { position: relative; transition: all 0.2s ease; border-radius: 8px; font-weight: 500; letter-spacing: -0.01em; }
        .nav-item:hover { background: #f3f4f6; }
        .nav-item.active { background: #e0e7ff; color: #4f46e5; }
        @media (min-width: 1024px) { .nav-item.active::before { content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 3px; height: 24px; background: #4f46e5; border-radius: 0 4px 4px 0; } }
        .nav-item svg { transition: transform 0.2s ease; }
        .nav-item:active { transform: scale(0.98); }

        @media (max-width: 640px) { button, a[class*="px-"], .btn { min-height: 44px; min-width: 44px; } }
        .material-content { word-wrap: break-word; }
        .material-content img { max-width: 100%; height: auto; border-radius: 0.5rem; margin: 1rem 0; }
        .material-content h1, .material-content h2, .material-content h3 { margin-top: 1.5rem; margin-bottom: 1rem; font-weight: bold; }
        .material-content h1 { font-size: 2rem; } .material-content h2 { font-size: 1.5rem; } .material-content h3 { font-size: 1.25rem; }
        .material-content ul, .material-content ol { margin: 1rem 0; padding-left: 2rem; }
        .material-content a { color: #4F46E5; text-decoration: underline; }
        .material-content a:hover { color: #4338CA; }

        .ql-editor { min-height: 300px; }
        .ql-container { font-size: 16px; border-radius: 0.5rem; }

        .ar-tag-description { max-height: 100px; overflow: hidden; text-overflow: ellipsis; }

        /* Mobile Navigation Styles */
        .mobile-nav-item { color: #64748b; transition: all 0.2s ease; }
        .mobile-nav-item.active { color: #4f46e5; }
        .mobile-nav-item:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">

<!-- Sidebar (Desktop) -->
<aside class="sidebar hidden lg:flex fixed left-0 top-0 bottom-0 w-64 z-40 flex-col">
    <div class="px-6 py-6 border-b border-gray-200">
        <div class="flex items-center space-x-3">
        <div class="w-20 h-20 rounded-xl flex items-center justify-center overflow-hidden">
            <img src="{{ url_for('static', path='images/logo.png') }}" alt="GemGuide Logo" class="w-full h-full object-contain">
        </div>
            <div>
                <h2 class="text-sm font-semibold text-gray-900">GemGuide.space</h2>
                <p class="text-xs text-gray-500">Corporate Learning Platform</p>
            </div>
        </div>
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 px-3 py-6 space-y-1 overflow-y-auto">
        <a href="/profile" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/profile') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
            <span class="text-sm font-medium">Мой профиль</span>
        </a>

        <a href="/chatbot" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/chatbot') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            <span class="text-sm font-medium">AI Ассистент</span>
        </a>

        <a href="/knowledge_base" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/knowledge_base') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
            <span class="text-sm font-medium">База знаний</span>
        </a>

        {% if current_user and current_user.is_admin %}
        <div class="my-4 px-4 border-t border-gray-200"></div>
        <div class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Управление</div>

        <a href="/auth/admin" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/auth/admin') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
            <span class="text-sm font-medium">Админ-панель</span>
        </a>

        <a href="/objects/manage" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/objects/manage') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"/>
            </svg>
            <span class="text-sm font-medium">AR/QR Управление</span>
        </a>
        {% endif %}

        <!-- Scanner for all users -->
        <a href="/objects/scanner" class="nav-item flex items-center px-4 py-3 text-gray-700 {% if request.url.path.startswith('/objects/scanner') %}active{% endif %}">
            <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span class="text-sm font-medium">AR/QR Сканер</span>
        </a>

    </nav>
</aside>

<!-- Main content -->
<main class="w-full px-0 sm:px-3 lg:px-4 py-0 sm:py-4 lg:py-6">
    {% block content %}{% endblock %}
</main>

<!-- Mobile Bottom Navigation -->
<nav class="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50">
    <div class="flex justify-around items-center h-16 px-2">
        <!-- Profile -->
        <a href="/profile" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/profile') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
            <span class="text-xs mt-1 font-medium">Профиль</span>
        </a>

        <!-- Chatbot -->
        <a href="/chatbot" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/chatbot') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            <span class="text-xs mt-1 font-medium">AI</span>
        </a>

        <!-- Knowledge Base -->
        <a href="/knowledge_base" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/knowledge_base') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
            <span class="text-xs mt-1 font-medium">База</span>
        </a>

        <!-- Scanner -->
        <a href="/objects/scanner" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/objects/scanner') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span class="text-xs mt-1 font-medium">Сканер</span>
        </a>

        {% if current_user and current_user.is_admin %}
        <!-- Admin Panel -->
        <a href="/auth/admin" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/auth/admin') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
            <span class="text-xs mt-1 font-medium">Админ</span>
        </a>

        <!-- AR/QR Management -->
        <a href="/objects/manage" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full relative {% if request.url.path.startswith('/objects/manage') %}active{% endif %}">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"/>
            </svg>
            <span class="text-xs mt-1 font-medium">Управление</span>
        </a>
        {% endif %}
    </div>
</nav>

</body>
</html>
